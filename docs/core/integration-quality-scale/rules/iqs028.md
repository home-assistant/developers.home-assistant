---
title: "IQS028 - The integration support passing in a websession"
---

IQS028 is as follows:

The integration support passing in a websession

## Reasoning

Since many devices and services are connected via HTTP, the number of active web sessions can be high.
To improve the efficiency of those web sessions, it is recommended to support passing in a web session.
These sessions are tweaked towards being used in Home Assistant and is more efficient.

Home Assistants supports this for [`aiohttp`](https://docs.aiohttp.org/en/stable/) and [`httpx`](https://www.python-httpx.org/).

## Example implementation

In the example below, a `aiohttp` session is passed in to the client.
The equivalent for `httpx` would be `get_async_client`.

```python
async def async_setup_entry(hass: HomeAssistant, entry: MyConfigEntry) -> bool:
    """Set up my integration from a config entry."""

    client = MyClient(entry.data[CONF_HOST], async_get_clientsession(hass))
```

:::info
There are cases where you might not want a shared session, for example when cookies are used.
In that case, you can create a new session using `async_create_clientsession` for `aiohttp` and `create_async_httpx_client` for `httpx`.
:::

## Additional resources


## Exceptions

If the integration is not making any HTTP requests, this rule does not apply.

## Related rules

- IQS027 - Dependency is async